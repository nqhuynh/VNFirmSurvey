---
title: "Skill intensity over years"
output: bookdown::pdf_document2 
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(VNFirmSurvey)
library(data.table)
library(ggplot2)
library(DataExplorer)
library(here)
library(haven)
library(labelled)
```

```{r}
data("skill_07_dta")
data("skill_01_dta")

dta_list <- list(skill_07_dta, skill_01_dta)

stacked_data <- rbindlist(dta_list)
```

```{r plot-skill}
stacked_data$svyear <- as.factor(stacked_data$svyear)

ggplot(stacked_data, aes(x = SI_1, col = svyear)) + 
  geom_density()

ggplot(stacked_data, aes(x = SI_2, col = svyear)) + 
  geom_density()

ggplot(stacked_data, aes(x = SI_3, col = svyear)) + 
  geom_density()
```

# Wage Data

```{r load-wage-data}

dta_list <- list(here("inst", "extdata", 
                    "Stata_2001", 
                    "dn2001.dta"), 
                 here("inst", "extdata", 
                    "Stata_2007", 
                    "dn2007.dta") )


wage_dta <- getWage(dta_list)
```

## Convert wage bill to USD 
Let's get exchange rate from the World Bank (PA.NUS.FCRF)
```{r exchange-rate}
library(WDI)
exchange_rate_US_VN <- WDI(country = "VN", 
    indicator = "PA.NUS.FCRF",
    start = 1999, 
    end = 2019)


ggplot(exchange_rate_US_VN, 
       aes(x = year, y = PA.NUS.FCRF)) + 
  geom_line() + 
  geom_point()

```


```{r merge-wage-EX-rate}
wage_dta_merged <- merge(wage_dta, 
     exchange_rate_US_VN, 
     by.x = "svyear", 
     by.y = "year")

wage_dta_merged[, wage_bill_USD := (wage_bill*1000000/PA.NUS.FCRF)]

```


