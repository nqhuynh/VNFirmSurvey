---
title: "Skill intensity over years"
output: bookdown::pdf_document2 
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(VNFirmSurvey)
library(data.table)
library(ggplot2)
library(DataExplorer)
library(here)
library(haven)
library(labelled)
library(dplyr)
library(labelled)
```

```{r load-data}
data("skill_07_dta")
data("skill_01_dta")


dta_list <- list(here("inst", "extdata", 
                    "Stata_2001", 
                    "dn2001.dta"), 
                 here("inst", "extdata", 
                    "Stata_2004", 
                    "dn2004.dta"),
                 here("inst", "extdata", 
                    "Stata_2007", 
                    "dn2007.dta") )

years <- c(2001, 2004, 2007)

```



## Location 

The location codes at district level change from 2004. I need a concodore between these two system 
```{r}

location_dta <- getLocation(dta_list)

location_dta[svyear == 2001, .(madn, xa, huyen, tinh)]

location_dta[svyear == 2007 & tinh == "01"
             & huyen == "001", .(madn, xa, huyen, tinh)]

```


## Entry, exit 
```{r}
dynamic_dta <- EntryExit(dta_list, base_year = years)
```




# Wage Data

```{r load-wage-data}

wage_dta <- getWage(dta_list)
```


```{r wage-distribution}
graph_wage <- merge(wage_dta[, .(svyear, wage_bill_USD)],
                    wage_dta[, .(mean_wage = mean(wage_bill_USD)), 
                       by = svyear], 
                    by = "svyear")

ggplot(graph_wage, aes(x = log(wage_bill_USD), col = factor(svyear))) + 
  geom_density()



```
